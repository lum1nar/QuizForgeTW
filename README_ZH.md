# ğŸ“˜ QuizForgeTW (ä¸­æ–‡ç‰ˆ)

**ä½¿ç”¨ agentic RAG æŠ€è¡“ï¼Œè¼•é¬†ç”Ÿæˆè‡ºç£é«˜ä¸­é¢¨æ ¼çš„è‹±æ–‡è€ƒé¡Œã€‚å¾ PDF è€ƒå·æª”æ¡ˆåˆ°å¯ç›´æ¥ä½¿ç”¨çš„é¡Œç›®ï¼ŒExamRAG å°‡æ™ºæ…§ã€èªå¢ƒèˆ‡è€ƒè©¦å°ˆæ¥­æ•´åˆæ–¼ä¸€å€‹æµç¨‹ä¸­ã€‚**

### âœ¨ ç‰¹è‰²åŠŸèƒ½

- **ğŸ§  æ™ºèƒ½ RAG æ±ºç­–**
  ç³»çµ±æœƒè‡ªå‹•åˆ¤æ–·æ˜¯å¦éœ€è¦æª¢ç´¢ç›¸é—œå…§å®¹ï¼Œå†ç”Ÿæˆé¡Œç›®â€”é¿å…æµªè²» prompt æˆ–å–å¾—ç„¡é—œè³‡æ–™ã€‚

- **ğŸ“„ è€ƒè©¦æ„ŸçŸ¥èªæ„åˆ†æ®µ**
  ä½¿ç”¨ LLM æ ¹æ“šè€ƒå·çµæ§‹èˆ‡èªå¢ƒåˆ†æ®µï¼Œè€Œéä»»æ„å›ºå®šå¤§å°ã€‚

- **ğŸ“š æ–‡æ³•èˆ‡è€ƒè©¦é¢¨æ ¼æª¢ç´¢**
  ç²¾æº–æ‰¾å‡ºç¬¦åˆèªæ„ã€æ–‡æ³•é‡é»çš„é¡Œç›®ï¼Œè²¼è¿‘è‡ºç£åœ‹ä¸­ã€é«˜ä¸­è€ƒè©¦é¢¨æ ¼ã€‚

- **ğŸ“ çœŸå¯¦æ„Ÿè€ƒé¡Œç”Ÿæˆ**
  æ”¯æ´å…‹æ¼å­—ã€æ–‡æ³•ã€é–±è®€ç†è§£é¡Œç›®â€”ç”Ÿæˆçš„é¡Œç›®èˆ‡çœŸå¯¦è€ƒè©¦é«˜åº¦ç›¸ä¼¼ã€‚

- **âš¡ é›¢ç·šç´¢å¼•ã€ç·šä¸Šå³æ™‚ç”Ÿæˆ**
  åµŒå…¥èˆ‡ç´¢å¼•å·¥ä½œå…¨éƒ¨é›¢ç·šå®Œæˆï¼Œç·šä¸Šç”Ÿæˆé¡Œç›®å¿«é€Ÿç©©å®šã€‚

---

## ğŸ§  ä½¿ç”¨æ¨¡å‹

| ç”¨é€”             | æ¨¡å‹                      |
| ---------------- | ------------------------- |
| åˆ†æ®µèˆ‡è€ƒé¡Œç”Ÿæˆ   | `gpt-oss:120b` (ncku)     |
| RAG æœå°‹æŸ¥è©¢ç”Ÿæˆ | `gpt-oss:20b` (ncku)      |
| è¼•é‡æ±ºç­–èˆ‡æ§åˆ¶   | `gemma3:4b` (ncku)        |
| æ–‡æœ¬åµŒå…¥         | `embeddinggemma` (Ollama) |
| å‘é‡è³‡æ–™åº«       | FAISS                     |

---

## ğŸ—ï¸ ç³»çµ±æµç¨‹æ¦‚è¦½

```mermaid
flowchart TD
    %% Offline: PDF â†’ VectorDB
    A[PDF æª”æ¡ˆ]
        --> B[pdfextractor / pdfplumber\næ“·å–åŸå§‹æ–‡å­—]

    B --> C[gpt-oss:120b\næ™ºèƒ½åˆ†æ®µ\nJSON Chunk]

    C --> D[é©—è­‰ JSON çµæ§‹]

    D --> E[all_chunks.json\næœ‰æ•ˆåˆ†æ®µ]

    E --> F[chunked_pdf.json\nè¨˜éŒ„å·²è™•ç† PDF]

    %% Embedding
    E --> G[ollama embeddinggamma\nåµŒå…¥æ–‡å­—åŠ metadata]

    G --> H[FAISS å‘é‡è³‡æ–™åº«\nexam_chunks.faiss]

    G --> I[Metadata å‚™ä»½\nexam_chunks_meta.json]

    %% Online: ä½¿ç”¨è€… â†’ é¡Œç›®ç”Ÿæˆ
    J[ä½¿ç”¨è€…è¼¸å…¥\nè€ƒé¡Œç”Ÿæˆè«‹æ±‚]
        --> K[gemma3:4b\næ˜¯å¦éœ€è¦ RAG?]

    K -->|å¦| L[gemma3:4b\nç›´æ¥ç”Ÿæˆç­”æ¡ˆ]

    K -->|æ˜¯| M[gpt-oss:20b\nç”Ÿæˆ RAG æœå°‹æŸ¥è©¢\nå…‹æ¼å­—é¡Œ]

    M --> N[embeddinggamma\nåµŒå…¥æŸ¥è©¢]

    N --> O[FAISS æœå°‹\nå‘é‡ç›¸ä¼¼åº¦]

    O --> P[å–å¾—åˆ†æ®µ\næ–‡æ³•èˆ‡ metadata]

    P --> Q[gpt-oss:20b\nç”Ÿæˆ RAG æœå°‹æŸ¥è©¢\né–±è®€é¡Œ]

    Q --> N

    P --> S[gpt-oss:120b\næ•´åˆç”Ÿæˆè€ƒé¡Œ]

    S --> T[æœ€çµ‚è€ƒé¡Œ]
```

---

## ğŸš€ å¿«é€Ÿé–‹å§‹ (Linux)

### 0. ç³»çµ±éœ€æ±‚

- Python 3.12
- [Ollama](https://ollama.com/) (éœ€å®‰è£)
- Ollama æ¨¡å‹ï¼š`embeddinggamma`

```bash
curl -fsSL https://ollama.com/install.sh | sh
ollama pull embeddinggamma
ollama serve
```

### 1. å®‰è£ä¾è³´

```bash
# å¯é¸ï¼šå»ºç«‹è™›æ“¬ç’°å¢ƒ
python3 -m venv venv
source venv/bin/activate  # Linux / Mac
pip install -r requirements.txt
```

### 2. ç’°å¢ƒè®Šæ•¸

å»ºç«‹ `.env` æª”æ¡ˆæ–¼å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼Œä¸¦å¡«å…¥ API Keyï¼š

```env
# .env
API_KEY=your_api_key_here
```

### 3. æº–å‚™ PDF

```bash
cd pdf
# å°‡è€ƒå· PDF æ”¾å…¥ ./pdf
```

### 4. é›¢ç·šåˆ†æ®µèˆ‡ç´¢å¼•

```bash
# PDF åˆ†æ®µæ•´ç†
python3 chunking.py

# å»ºç«‹å‘é‡åµŒå…¥
python3 embedding.py
```

### 5. å•Ÿå‹•ä»£ç† (Server æ¨¡å¼)

```bash
# å•Ÿå‹• FastAPI / Uvicorn ä¼ºæœå™¨
uvicorn server:app --host 0.0.0.0 --port 8000
```

- é–‹å•Ÿç€è¦½å™¨ä¸¦è¨ªå•ï¼š[http://localhost:8000](http://localhost:8000)
- ä½¿ç”¨å‰ç«¯è¼¸å…¥ prompt é–‹å§‹äº’å‹•ã€‚

---

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹

```bash
.
â”œâ”€â”€ pdf/                    # åŸå§‹è€ƒå· PDF
â”œâ”€â”€ prompts/                # Prompt æ¨¡æ¿
â”œâ”€â”€ json/                   # Chunk èˆ‡ metadata è¼¸å‡º
â”œâ”€â”€ exam_chunks.faiss       # FAISS ç´¢å¼•
â”œâ”€â”€ chunking.py             # é›¢ç·šåˆ†æ®µ
â”œâ”€â”€ embedding.py            # é›¢ç·šåµŒå…¥
â”œâ”€â”€ agent.py                # è€ƒé¡Œç”Ÿæˆ
â”œâ”€â”€ utils.py
â”œâ”€â”€ server.py               # æœ¬åœ° Web Server
```
