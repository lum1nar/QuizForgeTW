# ğŸ“˜ QuizForgeTW

[English Version](/README_EN.md)

![demo](./static/demo.png)

**ä½¿ç”¨ agentic RAG æŠ€è¡“ï¼Œè¼•é¬†ç”Ÿæˆè‡ºç£é«˜ä¸­é¢¨æ ¼çš„è‹±æ–‡è€ƒé¡Œã€‚å¾ PDF è€ƒå·æª”æ¡ˆåˆ°å¯ç›´æ¥ä½¿ç”¨çš„é¡Œç›®ï¼ŒQuizForgeTW å°‡æ™ºæ…§ã€èªå¢ƒèˆ‡è€ƒè©¦å°ˆæ¥­æ•´åˆæ–¼ä¸€å€‹æµç¨‹ä¸­ã€‚**

### âœ¨ ç‰¹è‰²åŠŸèƒ½

- **ğŸ§  æ™ºèƒ½ RAG æ±ºç­–**
  ç³»çµ±æœƒè‡ªå‹•åˆ¤æ–·æ˜¯å¦éœ€è¦æª¢ç´¢ç›¸é—œå…§å®¹ï¼Œå†ç”Ÿæˆé¡Œç›®â€”é¿å…æµªè²» prompt æˆ–å–å¾—ç„¡é—œè³‡æ–™ã€‚

- **ğŸ“„ è€ƒè©¦æ„ŸçŸ¥èªæ„åˆ†æ®µ**
  ä½¿ç”¨ LLM æ ¹æ“šè€ƒå·çµæ§‹èˆ‡èªå¢ƒåˆ†æ®µï¼Œè€Œéä»»æ„å›ºå®šå¤§å°ã€‚

- **ğŸ“š æ–‡æ³•èˆ‡è€ƒè©¦é¢¨æ ¼æª¢ç´¢**
  ç²¾æº–æ‰¾å‡ºç¬¦åˆèªæ„ã€æ–‡æ³•é‡é»çš„é¡Œç›®ï¼Œè²¼è¿‘è‡ºç£åœ‹ä¸­ã€é«˜ä¸­è€ƒè©¦é¢¨æ ¼ã€‚

- **ğŸ“ çœŸå¯¦æ„Ÿè€ƒé¡Œç”Ÿæˆ**
  æ”¯æ´å…‹æ¼å­—ã€æ–‡æ³•ã€é–±è®€ç†è§£é¡Œç›®â€”ç”Ÿæˆçš„é¡Œç›®èˆ‡çœŸå¯¦è€ƒè©¦é«˜åº¦ç›¸ä¼¼ã€‚

- **âš¡ é›¢ç·šç´¢å¼•ã€ç·šä¸Šå³æ™‚ç”Ÿæˆ**
  åµŒå…¥èˆ‡ç´¢å¼•å·¥ä½œå…¨éƒ¨é›¢ç·šå®Œæˆï¼Œç·šä¸Šç”Ÿæˆé¡Œç›®å¿«é€Ÿç©©å®šã€‚

### ğŸ“” è€ƒå·é‘‘åˆ¥åº¦

è«‹åƒè€ƒ [å‡ºé¡Œç¯„ä¾‹](./demo_output.pdf) ç¬¬ 8 é¡Œï¼Œå¦‚æœå­¸ç”Ÿèªçˆ² (A) (B) é¸é …éƒ½æ˜¯æ­£è§£ï¼Œ
ä»£è¡¨å­¸ç”Ÿå°šæœªå…·å‚™é—œä¿‚ä»£åè©ä¸­**éé™å®šç”¨æ³•**çš„è§€å¿µã€‚

> ç”±æ–¼å‡ºé¡Œéç¨‹æœƒå¤§é‡æ¡ç´æ­·å²é¡Œåº«ï¼Œå› æ­¤èƒ½å¤ é‡å°è‡ºç£åœ‹é«˜ä¸­æ®µè€ƒå…«è‚¡çš„**é™·é˜±é¡Œ**é€²è¡Œæ¸¬é©—

![Q8](./static/q8.png)

## ğŸ§  ä½¿ç”¨æ¨¡å‹

| ç”¨é€”             | æ¨¡å‹                      |
| ---------------- | ------------------------- |
| åˆ†æ®µèˆ‡è€ƒé¡Œç”Ÿæˆ   | `gpt-oss:120b` (ncku)     |
| RAG æœå°‹æŸ¥è©¢ç”Ÿæˆ | `gpt-oss:20b` (ncku)      |
| è¼•é‡æ±ºç­–èˆ‡æ§åˆ¶   | `gemma3:4b` (ncku)        |
| æ–‡æœ¬åµŒå…¥         | `embeddinggemma` (Ollama) |
| å‘é‡è³‡æ–™åº«       | FAISS                     |

## ğŸ—ï¸ ç³»çµ±æµç¨‹æ¦‚è¦½

```mermaid
flowchart TD
    %% =========================
    %% Offline: PDF â†’ VectorDB
    %% =========================

    A[PDF æª”æ¡ˆ]
        -->|æ“·å–åŸå§‹æ–‡å­—| B[pdfplumber]

    B -->|LLM æ™ºèƒ½åˆ†æ®µ| C[gpt-oss:120b]

    C -->|è¼¸å‡º JSON chunks| D[Chunk Validator]

    D -->|æœ‰æ•ˆåˆ†æ®µ| E[all_chunks.json]

    E -->|è¨˜éŒ„å·²è™•ç† PDF| F[chunked_pdf.json]

    %% Embedding
    E -->|åµŒå…¥æ–‡å­— + metadata| G[ollama embeddinggamma]

    G -->|å»ºç«‹å‘é‡ç´¢å¼•| H[FAISS VectorDB]

    G -->|å‚™ä»½ metadata| I[exam_chunks_meta.json]

    %% =========================
    %% Online: ä½¿ç”¨è€… â†’ é¡Œç›®ç”Ÿæˆ
    %% =========================

    J[ä½¿ç”¨è€…è«‹æ±‚]
        -->|åˆ¤æ–·æ˜¯å¦éœ€è¦ RAG| K[gemma3:4b]

    K -->|ä¸éœ€è¦| L[ç›´æ¥ç”Ÿæˆè€ƒé¡Œ]

    K -->|éœ€è¦| M[RAG Cloze æŸ¥è©¢ç”¢ç”Ÿå™¨ <br> gpt-oss:20b<br>]

    M -->|æŸ¥è©¢åµŒå…¥| N[embeddinggamma]

    N -->|å‘é‡ç›¸ä¼¼åº¦æœå°‹| O[FAISS]

    O -->|å–å¾—ç›¸é—œ chunks| P[æ–‡æ³• + metadata]

    P -->|è£œå……é–±è®€é¡ŒæŸ¥è©¢| Q[RAG é–±è®€é¡Œçµ„æŸ¥è©¢ç”¢ç”Ÿå™¨ <br> gpt-oss:20b<br>]

    Q --> |æŸ¥è©¢åµŒå…¥| N

    P -->|æ•´åˆå…§å®¹ç”Ÿæˆè€ƒé¡Œ| S[gpt-oss:120b]

    S --> T[æœ€çµ‚è€ƒé¡Œ]
```

## ğŸš€ å¿«é€Ÿé–‹å§‹ (Linux)

### 0. ç³»çµ±éœ€æ±‚

- Python 3.12
- [Ollama](https://ollama.com/) (éœ€å®‰è£)
- Ollama æ¨¡å‹ï¼š`embeddinggamma`

```bash
curl -fsSL https://ollama.com/install.sh | sh
ollama pull embeddinggamma
ollama serve
```

### 1. å®‰è£ä¾è³´

```bash
# å¯é¸ï¼šå»ºç«‹è™›æ“¬ç’°å¢ƒ
python3 -m venv venv
source venv/bin/activate  # Linux / Mac
pip install -r requirements.txt
```

### 2. ç’°å¢ƒè®Šæ•¸

å»ºç«‹ `.env` æª”æ¡ˆæ–¼å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼Œä¸¦å¡«å…¥ API Keyï¼š

```env
# .env
API_KEY=your_api_key_here
```

### 3. æº–å‚™ PDF

```bash
cd pdf
# å°‡è€ƒå· PDF æ”¾å…¥ ./pdf
```

### 4. é›¢ç·šåˆ†æ®µèˆ‡ç´¢å¼•

```bash
# PDF åˆ†æ®µæ•´ç†
python3 chunking.py

# å»ºç«‹å‘é‡åµŒå…¥
python3 embedding.py
```

### 5. å•Ÿå‹•ä»£ç† (Server æ¨¡å¼)

```bash
# å•Ÿå‹• FastAPI / Uvicorn ä¼ºæœå™¨
uvicorn server:app --host 0.0.0.0 --port 8000
```

- é–‹å•Ÿç€è¦½å™¨ä¸¦è¨ªå•ï¼š[http://localhost:8000](http://localhost:8000)
- ä½¿ç”¨å‰ç«¯è¼¸å…¥ prompt é–‹å§‹äº’å‹•ã€‚

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹

```bash
.
â”œâ”€â”€ pdf/                    # åŸå§‹è€ƒå· PDF
â”œâ”€â”€ prompts/                # Prompt æ¨¡æ¿
â”œâ”€â”€ json/                   # Chunk èˆ‡ metadata è¼¸å‡º
â”œâ”€â”€ exam_chunks.faiss       # FAISS ç´¢å¼•
â”œâ”€â”€ chunking.py             # é›¢ç·šåˆ†æ®µ
â”œâ”€â”€ embedding.py            # é›¢ç·šåµŒå…¥
â”œâ”€â”€ agent.py                # è€ƒé¡Œç”Ÿæˆ
â”œâ”€â”€ utils.py
â”œâ”€â”€ server.py               # æœ¬åœ° Web Server
```
